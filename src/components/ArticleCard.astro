---
import type { Article } from '../lib/database.types';

interface Props {
  article: Article;
  featured?: boolean;
}

const { article, featured = false } = Astro.props;


const formattedDate = article.published_at
  ? new Date(article.published_at).toLocaleDateString('en-US', {
      month: 'short',
      day: 'numeric',
      year: 'numeric',
    })
  : null;
---

<article
  class:list={[
    'group relative transition-colors hover:bg-bg-surface',
    featured ? 'md:col-span-2 md:row-span-2' : '',
  ]}
>
  <a href={`/news/${article.slug}`} class="block p-6">
    <!-- Category & Date -->
    <div class="flex items-center gap-3 mb-3">
      {article.category && (
        <span class="badge">
          {article.category}
        </span>
      )}
      {formattedDate && (
        <span class="text-text-muted text-xs">{formattedDate}</span>
      )}
    </div>

    <!-- Title -->
    <h3
      class:list={[
        'font-semibold text-white group-hover:text-silver-light transition-colors mb-3 line-clamp-2',
        featured ? 'text-2xl md:text-3xl' : 'text-base',
      ]}
    >
      {article.title}
    </h3>

    <!-- Summary -->
    {article.summary && (
      <p
        class:list={[
          'text-text-secondary line-clamp-3 mb-4',
          featured ? 'text-base' : 'text-sm',
        ]}
      >
        {article.summary}
      </p>
    )}

    <!-- Source -->
    <div class="flex items-center gap-2 text-text-muted text-xs">
      {article.source_name && (
        <>
          <span>{article.source_name}</span>
          <span class="w-1 h-1 bg-text-muted rounded-full"></span>
        </>
      )}
      <span class="group-hover:text-white transition-colors">Read more</span>
    </div>

    <!-- Featured Badge -->
    {featured && (
      <div class="absolute top-4 right-4">
        <span class="badge">Featured</span>
      </div>
    )}
  </a>
</article>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>
